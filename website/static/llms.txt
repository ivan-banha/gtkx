# GTKX

> Build native GTK4 desktop applications with React and TypeScript

GTKX bridges React's component model with GTK4's native widget system. Write familiar React code and render it as native Linux desktop applications.

## Documentation

- [Documentation](https://eugeniodepalo.github.io/gtkx)
- [GitHub](https://github.com/eugeniodepalo/gtkx)

## Quick Start

```bash
npx @gtkx/cli@latest create
cd my-app
npm run dev
```

## Build Commands

```bash
pnpm install          # Install dependencies
pnpm build            # Build all packages (turbo)
pnpm codegen          # Regenerate FFI/JSX bindings from GIR files
pnpm test             # Run tests (concurrency=1 due to GTK/X11 constraints)
pnpm lint             # Run biome check
```

## Architecture

GTKX is a monorepo (pnpm workspaces + Turbo) that enables building native GTK4 desktop applications with React.

### Package Dependency Graph

```
@gtkx/cli → @gtkx/react → @gtkx/ffi → @gtkx/native (Rust/libffi)
             ↓
          @gtkx/css (also → @gtkx/ffi)

@gtkx/testing → @gtkx/react + @gtkx/ffi + @gtkx/native
@gtkx/gir → Used for codegen in @gtkx/ffi & @gtkx/react
```

### Core Packages

- @gtkx/native: Rust native module (Neon/N-API) wrapping libffi for GTK4 function calls
- @gtkx/ffi: Auto-generated TypeScript bindings for GTK4/GDK/GLib (from GIR files)
- @gtkx/react: React 19 reconciler implementation + JSX components for GTK widgets
- @gtkx/cli: Vite-based dev server with HMR, project scaffolding
- @gtkx/css: Emotion-compatible CSS-in-JS for GTK styling
- @gtkx/testing: Testing Library-style utilities (render, screen, userEvent, queries)
- @gtkx/gir: GObject Introspection XML parser for codegen

### React Reconciler Architecture

The reconciler creates a Node tree that manages GTK widgets:

```
JSX → React Element → Reconciler → Node Factory → Node Tree → GTK Widgets
```

Key files:
- packages/react/src/reconciler.ts: React reconciler implementation
- packages/react/src/factory.ts: NODE_CLASSES map, switch-based type matching
- packages/react/src/node.ts: Base Node class
- packages/react/src/nodes/: Specialized nodes (WindowNode, GridNode, ListViewNode, etc.)

### Codegen System

Two generators parse GIR files to produce TypeScript:

1. FFI Generator (packages/ffi/src/codegen/ffi-generator.ts) → packages/ffi/src/generated/
2. JSX Generator (packages/react/src/codegen/jsx-generator.ts) → packages/react/src/generated/jsx.ts

Never edit generated code directly. Run `pnpm codegen` after modifying generators or GIR files.

## Testing

- Tests require GTK4/X11. CI uses Xvfb on Fedora.
- Tests run serially due to GTK's single-threaded nature.

## Requirements

- Node.js 20+
- GTK4
- Linux (GTK4 is Linux-native)
- Rust (for building native module)

## License

MPL-2.0
